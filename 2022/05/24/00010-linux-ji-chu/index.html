<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="00010-Linux 基础, NLP LLM DeepLearning LuYF-Lemon-love 自然语言处理 深度学习 大语言模型">
    <meta name="description" content="前言Linux 是 UNIX 操作系统的一个克隆系统，但是 Linux 操作系统是开源的。因此 Linux 自从但是以来就是企业级服务器的首选操作系统。它和 Git 一直是学生从学校到企业的两个拦路虎。所以学习 Linux 操作系统是必要的">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>00010-Linux 基础 | LuYF-Lemon-love の Blog</title>
    <link rel="icon" type="image/jpeg" href="https://cos.luyf-lemon-love.space/images/苏苏1.jpeg">
    
    <style>
        body{
            background-image: url(https://cos.luyf-lemon-love.space/images/016-%E6%8A%A5%E7%BA%B8%E5%A2%99%E9%BA%BB%E8%A1%A3%E5%AD%A6%E5%A7%90.jpg);
            background-repeat:no-repeat;
            background-size: 100% 100%;
            background-attachment:fixed;
        }
    </style>



    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <span class="logo-span">LuYF-Lemon-love の Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>List</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Image</span>
        </a>
      </li>
      
      <li>
        <a href="/verse">
          
          <i class="fas fa-comments" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Verse</span>
        </a>
      </li>
      
      <li>
        <a href="/bilibili">
          
          <i class="fas fa-video" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Bilibili</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <div class="logo-name">LuYF-Lemon-love の Blog</div>
        <div class="logo-desc">
            
            天之道，损有余而补不足，人之道则不然，损不足以奉有余。
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			List
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/galleries " style="margin-left:75px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:50px" ></i>
			      
		          <span>Image</span>
                  </a>
                </li>
              
                <li>

                  <a href="/verse " style="margin-left:75px">
				  
				   <i class="fa fas fa-comments" style="position: absolute;left:50px" ></i>
			      
		          <span>Verse</span>
                  </a>
                </li>
              
                <li>

                  <a href="/bilibili " style="margin-left:75px">
				  
				   <i class="fa fas fa-video" style="position: absolute;left:50px" ></i>
			      
		          <span>Bilibili</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/yanfeng98/paper-is-all-you-need" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/yanfeng98/paper-is-all-you-need" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cos.luyf-lemon-love.space/images/20220520215149.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">00010-Linux 基础</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Linux/">
                                <span class="chip bg-color">Linux</span>
                            </a>
                        
                            <a href="/tags/C/">
                                <span class="chip bg-color">C++</span>
                            </a>
                        
                            <a href="/tags/make/">
                                <span class="chip bg-color">make</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" class="post-category">
                                计算机基础
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-05-24
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2024-12-28
                </div>
                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        
        <!-- 代码块折行 -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Linux 是 UNIX 操作系统的一个克隆系统，但是 Linux 操作系统是开源的。因此 Linux 自从但是以来就是企业级服务器的首选操作系统。它和 Git 一直是学生从学校到企业的两个拦路虎。所以学习 Linux 操作系统是必要的。</p>
<p>操作系统：Ubuntu 20.04.4 LTS。</p>
<h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ol>
<li><p><a href="https://subingwen.cn/linux/">苏丙榅老师的 Linux 教程</a></p>
</li>
<li><p><a href="https://subingwen.cn/linux/vimplus/">vim 插件快速安装</a></p>
</li>
<li><p><a href="https://blog.csdn.net/steveforever/article/details/109231599">vimplus修改终端字体为Droid Sans Mono Nerd Font</a></p>
</li>
<li><p><a href="https://blog.csdn.net/C_SESER/article/details/75453380">cc和gcc</a></p>
</li>
</ol>
<h3 id="初识-Linux-操作系统"><a href="#初识-Linux-操作系统" class="headerlink" title="初识 Linux 操作系统"></a>初识 Linux 操作系统</h3><h4 id="Linux-的发展历程"><a href="#Linux-的发展历程" class="headerlink" title="Linux 的发展历程"></a>Linux 的发展历程</h4><p>1991 年初林纳斯 · 托瓦兹开始在一台 386sx 兼容微机上学习 minix 操作系统。<br>04林纳斯 · 托瓦兹开始酝酿并着手编制自己的操作系统。<br>04-13林纳斯 · 托瓦兹在 comp.os.minix 上宣布自己已经成功地将 bash 移植到了 minix 上了。<br>10-05林纳斯 · 托瓦兹在 comp.os.minix 宣布 Linux 内核已经诞生。<br>1992 Linux 与其他 GNU 软件结合，完全自由的操作系统 GNU&#x2F;Linux 诞生。<br>1993 Linux 0.99 的代码量有十万行，用户有 10 万个左右。<br>1994 03 Linux 1.0 发布，公有 17 万行代码。不久正式采用 GPL 协议。</p>
<p><strong>Linux 特性</strong></p>
<ul>
<li><p>Linux 是一个基于文件的操作系统。甚至像鼠标键盘等硬件都被抽象成一个设备文件来管理。</p>
</li>
<li><p>多个用户可以同时登录，每个用户同时可以运行多个应用程序。</p>
</li>
<li><p>是一个自由软件，免费且开源。</p>
</li>
</ul>
<p><strong>POSIX</strong> ，英文全称为 Portable Operating System Interface for Computing Systems，是由 IEEE 和 ISO&#x2F;IEC 开发的一套接口标准，保证所编制的应用程序在源代码一级可以在多种操作系统上可移植。中文名为 可移植操作系统接口。</p>
<p><strong>Linux 发行版</strong>，对于初学者接触的两个最常见的发行版为</p>
<ul>
<li><p><a href="https://www.centos.org/">CentOS Linux</a> 发行版是一个稳定、可预测、可管理和可重现的平台，源自红帽 Linux（ RHEL ）的源代码。</p>
</li>
<li><p><a href="https://ubuntu.com/">Ubuntu</a> 发行版最大的特点就是具有优秀易用的桌面环境，基于 Debian Linux 发行版。</p>
</li>
</ul>
<h4 id="Linux-内核"><a href="#Linux-内核" class="headerlink" title="Linux 内核"></a>Linux 内核</h4><p>Linux 内核主要包含 5 个子系统：进程调度、内存管理、虚拟文件系统、网路接口和进程间通信。</p>
<ul>
<li><p>进程调度 SCHED 是操作系统对进程的多种状态之间的转换策略。</p>
<ul>
<li><p>SCHED_OTHER: 分时调度策略（默认），用于针对普通进程的时间片轮转调度策略。</p>
</li>
<li><p>SCHED_FIFO: 实时调度策略，是针对运行的实时性要求比较高、运行时间短的进程调度策略。</p>
</li>
<li><p>SCHED_RR: 实时调度策略，是针对实时性要求比较高、运行时间比较长的进程调度策略。</p>
</li>
</ul>
</li>
<li><p>内存管理 MMU</p>
<ul>
<li><p>内存管理是多个进程间的内存共享策略。指的是虚拟内存。</p>
</li>
<li><p>虚拟内存可以让进程拥有比实际物理内存更大的内存。</p>
</li>
<li><p>每个进程的虚拟内存存在不同的地址空间，多个进程的虚拟内存不会冲突。</p>
</li>
</ul>
</li>
<li><p>虚拟文件系统 VFS</p>
<ul>
<li>Linux 支持多种文件系统，目前最常用的文件系统为 ext2 和 ext3。</li>
</ul>
</li>
<li><p>网路接口</p>
<ul>
<li><p>网络接口包括网络协议和驱动程序。</p>
</li>
<li><p>网络协议是一种网络传输的通信标准。</p>
</li>
<li><p>网络驱动程序是硬件设备的驱动程序。</p>
</li>
</ul>
</li>
<li><p>进程间通信</p>
<ul>
<li>通信方式包括管道、信号、消息队列、共享内存和套接字。</li>
</ul>
</li>
</ul>
<p><img src="https://cos.luyf-lemon-love.space/images/20220525145427.png" title="Linux 内核"></p>
<h4 id="Linux-目录"><a href="#Linux-目录" class="headerlink" title="Linux 目录"></a>Linux 目录</h4><p>Linux 文件系统是一个树状结构，只有一个单独的顶级目录结构，叫做<code>根目录</code>，更目录的子目录结构相对固定。</p>
<ul>
<li><p>bin: 二进制文件目录，存储了可执行程序。</p>
</li>
<li><p>sbin: root 用户使用的一些二进制可执行程序。</p>
</li>
<li><p>etc: 应用程序的配置文件目录。</p>
</li>
<li><p>lib: 存储了一些动态链接库和静态链接库。</p>
</li>
<li><p>media: 挂载目录，挂载外部设备：光驱，扫描仪等。</p>
</li>
<li><p>mnt: 临时挂载目录，如 U 盘。</p>
</li>
<li><p>proc: 内存使用的映射目录，操作系统使用。</p>
</li>
<li><p>tmp: 临时目录，存放临时数据，重启电脑时，数据被自动删除。</p>
</li>
<li><p>boot: 存储了开机相关的配置。</p>
</li>
<li><p>home: 普通用户的家目录。</p>
</li>
<li><p>root: root 用户的家目录。</p>
</li>
<li><p>dev: 设备目录，如 键盘、鼠标。</p>
</li>
<li><p>lost+found: 存储用于电脑异常关闭&#x2F;崩溃时恢复系统的文件。</p>
</li>
<li><p>opt: 第三方软件的安装目录。</p>
</li>
<li><p>var: 存储日志等经常发生变化的文件。</p>
</li>
<li><p>usr: 系统资源目录。</p>
<ul>
<li><p>&#x2F;usr&#x2F;bin: 可执行的二进制应用程序。</p>
</li>
<li><p>&#x2F;usr&#x2F;games: 游戏目录。</p>
</li>
<li><p>&#x2F;usr&#x2F;include: 包含标准头文件。</p>
</li>
<li><p>&#x2F;usr&#x2F;local: 第三方软件安装目录。</p>
</li>
</ul>
</li>
</ul>
<h4 id="文件路径"><a href="#文件路径" class="headerlink" title="文件路径"></a>文件路径</h4><p><strong>相对路径</strong></p>
<ul>
<li><code>./</code>: 等价于 <code>.</code>，代表当前目录。</li>
<li><code>../</code>: 等价于 <code>..</code>，代表上一级目录。</li>
</ul>
<p><strong>绝对路径</strong>：从系统磁盘起始节点开始描述的路径。如 <code>/usr/games</code>。</p>
<h4 id="命令解析器"><a href="#命令解析器" class="headerlink" title="命令解析器"></a>命令解析器</h4><p>命令解析器经常有 <code>bash</code> 和 <code>shell</code> 两个名字。<code>shell</code> 是 Bourne 为 <code>Unix</code> 操作系统写的命令解析器。<code>bash</code> 是 Bourne 为 <code>Linux</code> 操作系统写的命令解析器。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 打印环境变量</span>
<span class="token builtin class-name">echo</span> <span class="token environment constant">$PATH</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>命令提示行</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@lyfubuntu:~/local<span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><p>root: 当前登录的用户的用户名。</p>
</li>
<li><p>@: at -&gt; 在</p>
</li>
<li><p>lyfubuntu: 主机名。</p>
</li>
<li><p>~: 表示家目录。</p>
</li>
<li><p>~&#x2F;local: 表示当前用户所在的工作目录。</p>
</li>
<li><p>#: 表示当前用户是 root 用户。</p>
</li>
<li><p>$: 表示当前用户是普通用户。</p>
</li>
</ul>
<p><strong>命令行快捷键</strong></p>
<ul>
<li><p>Tab: 命令自动补齐。</p>
</li>
<li><p>Ctrl+p: 显示上一个输入的历史命令。等价于 ↑ 键。</p>
</li>
<li><p>Ctrl+n: 显示下一个输入的历史命令。等价于 ↓ 键。</p>
</li>
<li><p>Ctrl+a: 光标移动到命令行首。等价于 Home 键。</p>
</li>
<li><p>Ctrl+e: 光标移动到命令行尾。等价于 End 键。</p>
</li>
<li><p>Ctrl+u: 删除光标前的部分字符串。</p>
</li>
<li><p>Ctrl+k: 删除光标后的部分字符串。</p>
</li>
<li><p>→: 光标向右移动一个字符。</p>
</li>
<li><p>←：光标向左移动一个字符。</p>
</li>
<li><p>Backspace: 删除光标前的一个字符。</p>
</li>
<li><p>Delete: 删除光标后的一个字符。</p>
</li>
</ul>
<h3 id="Vim-的使用"><a href="#Vim-的使用" class="headerlink" title="Vim 的使用"></a>Vim 的使用</h3><p><code>Vim</code> 是 Linux 操作系统中一款功能强大的文本编辑器，支持安装各种插件，但是所有的操作都是通过键盘快捷键操作完成的。<code>Vim</code> 是 <code>Vi</code> 的增强版。</p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">vim</span>

<span class="token function">vim</span> <span class="token parameter variable">--version</span>

<span class="token comment"># 查看使用文档</span>
vimtutor<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Vim-的模式"><a href="#Vim-的模式" class="headerlink" title="Vim 的模式"></a>Vim 的模式</h4><p>Vim 一共有三种模式，分别是 <code>命令模式</code>，<code>末行模式</code>，<code>编辑模式</code>，默认进入的是 <code>命令模式</code>。</p>
<h5 id="命令模式下的操作"><a href="#命令模式下的操作" class="headerlink" title="命令模式下的操作"></a>命令模式下的操作</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 打开一个文件，如果文件不存在，并且退出的时候进行了保存，文件会被创建。</span>
<span class="token function">vim</span> 文件名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="保存退出"><a href="#保存退出" class="headerlink" title="保存退出"></a>保存退出</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 先按住 shift 键，然后连续按两次 z</span>
ZZ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="代码格式化"><a href="#代码格式化" class="headerlink" title="代码格式化"></a>代码格式化</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 假设写的 c/c++ 代码没有对齐，通过该命令可以对齐代码</span>
<span class="token comment"># 一定要注意最后一个字符是大写的 G，因此需要先按 shift 键</span>
<span class="token assign-left variable">gg</span><span class="token operator">=</span>G<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="光标的移动"><a href="#光标的移动" class="headerlink" title="光标的移动"></a>光标的移动</h5><ul>
<li>↑ | k: 光标上移</li>
<li>↓ | j: 光标下移</li>
<li>← | h: 光标左移</li>
<li>→ | l: 光标右移</li>
<li>0: 光标移动到行首</li>
<li>$: 光标移动到行尾</li>
<li>gg: 光标移动到第一行的开始</li>
<li>G: 光标移动到最后一行的开始</li>
<li>nG: 行跳转，n 代表要跳转到哪一行</li>
<li>n+Enter: 相对跳转 n 行，从光标所在行往下跳 n 行</li>
</ul>
<h5 id="删除（剪切）命令"><a href="#删除（剪切）命令" class="headerlink" title="删除（剪切）命令"></a>删除（剪切）命令</h5><ul>
<li>x: 删除光标盖住的字符</li>
<li>X: 删除光标前边的字符</li>
<li>dw: 删除光标所在单词的右边字符</li>
<li>d0: 删除光标前的字符串</li>
<li>d$ | D: 删除光标后的字符串</li>
<li>dd: 删除光标所在行</li>
<li>ndd: 从光标所在行开始删除 n 行</li>
</ul>
<h5 id="撤销和反撤销"><a href="#撤销和反撤销" class="headerlink" title="撤销和反撤销"></a>撤销和反撤销</h5><ul>
<li>u: 撤销，等价于 windows 中的 ctrl+z</li>
<li>Ctrl+r: 反撤销，等价于 windows 中的 ctrl+y</li>
</ul>
<h5 id="复制和粘贴"><a href="#复制和粘贴" class="headerlink" title="复制和粘贴"></a>复制和粘贴</h5><ul>
<li>p: 粘贴到光标所在行的下边</li>
<li>P: 粘贴到光标所在行的上边</li>
<li>yy: 复制光标所在行</li>
<li>nyy: 从光标所在行向下复制 n 行</li>
</ul>
<h5 id="可视模式"><a href="#可视模式" class="headerlink" title="可视模式"></a>可视模式</h5><ul>
<li>v: 进入字符可视模式（ Characterwise visual mode )，文本选择是以字符为单位的。</li>
<li>V: 进入行可视模式（ Linewise visual mode )，文本选择是以行为单位的。</li>
<li>Ctrl+v: 进入块可视模式（ Blockwise visual mode )，可以选择一个矩形形状的文本。</li>
</ul>
<p>进入到可视模式后</p>
<ul>
<li>h: 光标向左移动</li>
<li>j: 光标向下移动</li>
<li>k: 光标向上移动</li>
<li>l: 光标向右移动</li>
<li>d: 剪切</li>
<li>y: 复制</li>
<li>p: 粘贴到光标的后边</li>
<li>P: 粘贴到光标的前边</li>
</ul>
<h5 id="代码注释"><a href="#代码注释" class="headerlink" title="代码注释"></a>代码注释</h5><p>代码块注释使用块可视模式：</p>
<ol>
<li>Ctrl+v 进入块可视模式</li>
<li>通过 k 和 j 使得光标上移或者下移，选中多个代码行的开头。</li>
<li>选择完毕后，按大写的 I 键，输入注释符。</li>
<li>按 Esc 键。</li>
</ol>
<p>删除代码块注释：</p>
<ol>
<li>Ctrl+v 进入块可视模式</li>
<li>移动光标选中注释符</li>
<li>按 d 键</li>
</ol>
<h5 id="替换"><a href="#替换" class="headerlink" title="替换"></a>替换</h5><ul>
<li>r: 替换光标后的单个字符</li>
<li>R: 替换光标后的多个字符，按 Esc 键结束替换</li>
</ul>
<h5 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h5><ul>
<li>&#x2F;: <code>n</code> 从当前位置向下，<code>N</code> 从当前位置向上</li>
<li>?: <code>n</code> 从当前位置向上，<code>N</code> 从当前位置向下</li>
<li>#: ‘n’ 从当前位置向上，<code>N</code> 从当前位置向下，光标需要先放置在被搜索的关键字上。</li>
</ul>
<h5 id="查看-man-文档"><a href="#查看-man-文档" class="headerlink" title="查看 man 文档"></a>查看 man 文档</h5><p>man 文档一共有 9 个章节，具体如下：</p>
<ul>
<li>section 1: Linux 提供的所有 shell 命令</li>
<li>section 2: 系统函数（由内核提供）</li>
<li>section 3: 库调用函数（程序库中的函数）</li>
<li>section 4: 特殊文件（通常存放在 &#x2F;dev 目录中）</li>
<li>section 5: 系统配置文件格式和约定，比如：&#x2F;etc&#x2F;passwd</li>
<li>section 6: 游戏</li>
<li>section 7: 杂项（包括宏包和约定）</li>
<li>section 8: 系统管理命令（通常针对 root 用户）</li>
<li>section 9: 内核例程（非标准）</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 打开 man 文档首页</span>
<span class="token function">man</span> <span class="token function">man</span>

<span class="token comment"># 退出</span>
q

<span class="token comment"># 查询第一章的 shell 命令</span>
<span class="token function">man</span> <span class="token number">1</span> <span class="token function">cp</span>

<span class="token comment"># 查询第二章的系统函数（如：read, write, open 等）</span>
<span class="token function">man</span> <span class="token number">2</span> <span class="token builtin class-name">read</span>

<span class="token comment"># 查询第三章的标准的库函数（如：fread, fwrite, fopen 等）</span>
<span class="token function">man</span> <span class="token number">3</span> fread

<span class="token comment"># 查询第五章的特殊的配置文件说明，比如：/etc/passwd 或者 /etc/group </span>
<span class="token function">man</span> <span class="token number">5</span> <span class="token function">passwd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Vim 的命令模式下</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 首先将光标放在要查看的函数上</span>
章节号（可选）+ K<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="切换到编辑模式"><a href="#切换到编辑模式" class="headerlink" title="切换到编辑模式"></a>切换到编辑模式</h5><ul>
<li>i: 从光标的前边开始输入</li>
<li>a: 从光标的后边开始输入</li>
<li>o: 在光标下边新建行，在新行中输入</li>
<li>s: 删除光标盖住的字符，从删除的字符位置开始输入</li>
<li>I: 从当前行行首开始输入</li>
<li>A: 从当前行行尾开始输入</li>
<li>O: 在光标上边新建行，在新行中输入</li>
<li>S: 删除当前行，在当前行开始输入</li>
<li>Rsc: 从编辑模式退回到命令模式</li>
</ul>
<h4 id="末行模式下的操作"><a href="#末行模式下的操作" class="headerlink" title="末行模式下的操作"></a>末行模式下的操作</h4><h5 id="命令模式和末行模式相互切换"><a href="#命令模式和末行模式相互切换" class="headerlink" title="命令模式和末行模式相互切换"></a>命令模式和末行模式相互切换</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 命令模式切换到末行模式</span>
：

<span class="token comment"># 末行模式切换到命令模式</span>
<span class="token number">1</span>. 按两次 Esc
<span class="token number">2</span>. 末行模式执行完成一个命令后，自动退回命令模式<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="保存退出-1"><a href="#保存退出-1" class="headerlink" title="保存退出"></a>保存退出</h5><ul>
<li>q: 退出，如果没有保存文件，Vim 会给出提示是否要保存</li>
<li>q!: 直接退出，不保存</li>
<li>w: 保存，不退出</li>
<li>wq | x: 保存退出</li>
</ul>
<h5 id="替换-1"><a href="#替换-1" class="headerlink" title="替换"></a>替换</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># /g 表示做整行替换</span>
<span class="token comment"># 只对光标所在行进行替换</span>
s/被替换的关键字/新的关键字/g

<span class="token comment"># [行号1，行号2] 是一个从小到大的范围，对这个范围进行替换</span>
行号 <span class="token number">1</span>, 行号 2s/被替换的关键字/新的关键字/g

<span class="token comment"># 对所有行进行替换</span>
%s/被替换的关键字/新的关键字/g<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="分屏"><a href="#分屏" class="headerlink" title="分屏"></a>分屏</h5><ul>
<li>sp: 水平分屏，多个窗口垂直排列，多个窗口中显示同一文件里的内容</li>
<li>vsp: 垂直分屏，多个窗口水平排列，多个窗口中显示同一个文件里的内容</li>
<li>Ctrl+w+w: 光标在打开的屏幕之间切换，按住 Ctrl 然后按两次 w</li>
<li>qall: 同时退出多个屏幕</li>
<li>wqall: 同时保存退出多个屏幕</li>
<li>sp 文件名：分屏的同时指定打开的文件的名字</li>
<li>vsp 文件名：分屏的同时指定打开的文件的名字</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 在打开文件的时候指定分屏</span>
<span class="token comment"># 水平分屏</span>
<span class="token function">vim</span> <span class="token parameter variable">-o</span> 文件1,文件2,文件3
<span class="token comment"># 垂直分屏</span>
<span class="token function">vim</span> <span class="token parameter variable">-O</span> 文件1,文件2,文件3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="行跳转"><a href="#行跳转" class="headerlink" title="行跳转"></a>行跳转</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">:行号 <span class="token comment"># 输入完行号之后敲 Enter 键</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="执行-shell-命令"><a href="#执行-shell-命令" class="headerlink" title="执行 shell 命令"></a>执行 shell 命令</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 语法</span>
:<span class="token operator">!</span>shell命令

<span class="token comment"># 举例</span>
:<span class="token operator">!</span>ls<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Vim-配置文件"><a href="#Vim-配置文件" class="headerlink" title="Vim 配置文件"></a>Vim 配置文件</h4><ul>
<li>~&#x2F;.vimrc: 用户级别的配置文件</li>
<li>&#x2F;ect&#x2F;vim&#x2F;vimrc: 系统级别的配置文件</li>
<li>用户级别的配置文件优先级高</li>
</ul>
<h4 id="Vim-插件快速按安装"><a href="#Vim-插件快速按安装" class="headerlink" title="Vim 插件快速按安装"></a>Vim 插件快速按安装</h4><p><a href="https://github.com/chxuan/vimplus">vimplus</a>: An automatic configuration program for vim.</p>
<h5 id="安装vimplus"><a href="#安装vimplus" class="headerlink" title="安装vimplus"></a>安装vimplus</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/chxuan/vimplus.git ~/.vimplus
<span class="token builtin class-name">cd</span> ~/.vimplus
./install.sh //不加sudo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="设置Nerd-Font"><a href="#设置Nerd-Font" class="headerlink" title="设置Nerd Font"></a>设置Nerd Font</h5><p>为防止vimplus显示乱码，需设置linux终端字体为<code>Droid Sans Mono Nerd Font</code>。</p>
<ol>
<li>在<a href="https://github.com/ryanoasis/nerd-fonts">nerd-fonts</a> 的 readme.md 文件的 Patched Fonts 处下载字体</li>
</ol>
<p><img src="https://cos.luyf-lemon-love.space/images/20220526213314.png"></p>
<p><img src="https://cos.luyf-lemon-love.space/images/20220526213407.png"></p>
<p><img src="https://cos.luyf-lemon-love.space/images/20220526213450.png"></p>
<ol start="2">
<li>进入complete文件夹，选择下载</li>
</ol>
<p><img src="https://cos.luyf-lemon-love.space/images/20220526213616.png"></p>
<ol start="3">
<li><p>双击下载的字体文件，进行安装</p>
</li>
<li><p>在 terminal 设置，右击选择配置文件首选项(P)</p>
</li>
<li><p>选择字体</p>
</li>
</ol>
<p><img src="https://cos.luyf-lemon-love.space/images/20220526213925.png"></p>
<p><img src="https://cos.luyf-lemon-love.space/images/20220526214011.png"></p>
<h5 id="多用户支持"><a href="#多用户支持" class="headerlink" title="多用户支持"></a>多用户支持</h5><p>将vimplus在某个用户下安装好后，若需要在其他用户也能够使用vimplus，则执行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ./install_to_user.sh username1 username2 //替换为真实用户名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="更新vimplus"><a href="#更新vimplus" class="headerlink" title="更新vimplus"></a>更新vimplus</h5><p>紧跟vimplus的步伐，尝鲜新特性</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./update.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h5><ul>
<li>~&#x2F;.vimrc 为 vimplus 的默认配置，一般不做修改</li>
<li>~&#x2F;.vimrc.custom.plugins 为用户自定义插件列表，用户增加、卸载插件请修改该文件</li>
<li>~&#x2F;.vimrc.custom.config 为用户自定义配置文件，一般性配置请放入该文件，可覆盖 ~&#x2F;.vimrc 里的配置</li>
</ul>
<h5 id="插件列表"><a href="#插件列表" class="headerlink" title="插件列表"></a>插件列表</h5><table>
<thead>
<tr>
<th>插件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>cpp-mode</td>
<td>提供生成函数实现、函数声明&#x2F;实现跳转、.h .cpp切换等功能(I’m author:smile:)</td>
</tr>
<tr>
<td>vim-edit</td>
<td>方便的文本编辑插件(I’m author:smile:)</td>
</tr>
<tr>
<td>change-colorscheme</td>
<td>随心所欲切换主题(I’m author:smile:)</td>
</tr>
<tr>
<td>prepare-code</td>
<td>新建文件时，生成预定义代码片段(I’m author:smile:)</td>
</tr>
<tr>
<td>vim-buffer</td>
<td>vim缓存操作(I’m author:smile:)</td>
</tr>
<tr>
<td>vimplus-startify</td>
<td>vimplus开始页面</td>
</tr>
<tr>
<td>tagbar</td>
<td>使用 preservim&#x2F;tagbar 的最新版本，taglist 的替代品，显示类&#x2F;方法&#x2F;变量</td>
</tr>
<tr>
<td>vim-plug</td>
<td>比 Vundle 下载更快的插件管理软件</td>
</tr>
<tr>
<td>YouCompleteMe</td>
<td>史上最强大的基于语义的自动补全插件，支持C&#x2F;C++、C#、Python、PHP等语言</td>
</tr>
<tr>
<td>NerdTree</td>
<td>代码资源管理器</td>
</tr>
<tr>
<td>vim-nerdtree-syntax-highlight</td>
<td>NerdTree文件类型高亮</td>
</tr>
<tr>
<td>nerdtree-git-plugin</td>
<td>NerdTree显示git状态</td>
</tr>
<tr>
<td>vim-devicons</td>
<td>显示文件类型图标</td>
</tr>
<tr>
<td>Airline</td>
<td>可以取代 powerline 的状态栏美化插件</td>
</tr>
<tr>
<td>auto-pairs</td>
<td>自动补全引号、圆括号、花括号等</td>
</tr>
<tr>
<td>LeaderF</td>
<td>比 ctrlp 更强大的文件的模糊搜索工具</td>
</tr>
<tr>
<td>ack</td>
<td>强大的文本搜索工具</td>
</tr>
<tr>
<td>vim-surround</td>
<td>自动增加、替换配对符的插件</td>
</tr>
<tr>
<td>vim-commentary</td>
<td>快速注释代码插件</td>
</tr>
<tr>
<td>vim-repeat</td>
<td>重复上一次操作</td>
</tr>
<tr>
<td>vim-endwise</td>
<td>if&#x2F;end&#x2F;endif&#x2F;endfunction补全</td>
</tr>
<tr>
<td>tabular</td>
<td>代码、注释、表格对齐</td>
</tr>
<tr>
<td>vim-easymotion</td>
<td>强大的光标快速移动工具，强大到颠覆你的插件观</td>
</tr>
<tr>
<td>incsearch.vim</td>
<td>模糊字符搜索插件</td>
</tr>
<tr>
<td>vim-fugitive</td>
<td>集成Git</td>
</tr>
<tr>
<td>gv</td>
<td>显示 git 提交记录</td>
</tr>
<tr>
<td>vim-slash</td>
<td>优化搜索，移动光标后清除高亮</td>
</tr>
<tr>
<td>echodoc</td>
<td>补全函数时在命令栏显示函数签名</td>
</tr>
<tr>
<td>vim-smooth-scroll</td>
<td>让翻页更顺畅</td>
</tr>
<tr>
<td>clever-f.vim</td>
<td>强化f和F键</td>
</tr>
</tbody></table>
<h5 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h5><p>以下是部分快捷键，可通过vimplus的<code>,h</code>命令查看 vimplus帮助文档。</p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>,</code></td>
<td>Leader Key</td>
</tr>
<tr>
<td><code>&lt;leader&gt;n</code></td>
<td>打开&#x2F;关闭代码资源管理器</td>
</tr>
<tr>
<td><code>&lt;leader&gt;t</code></td>
<td>打开&#x2F;关闭函数列表</td>
</tr>
<tr>
<td><code>&lt;leader&gt;a</code></td>
<td>.h .cpp 文件切换</td>
</tr>
<tr>
<td><code>&lt;leader&gt;u</code></td>
<td>转到函数声明</td>
</tr>
<tr>
<td><code>&lt;leader&gt;U</code></td>
<td>转到函数实现</td>
</tr>
<tr>
<td><code>&lt;leader&gt;u</code></td>
<td>转到变量声明</td>
</tr>
<tr>
<td><code>&lt;leader&gt;o</code></td>
<td>打开include文件</td>
</tr>
<tr>
<td><code>&lt;leader&gt;y</code></td>
<td>拷贝函数声明</td>
</tr>
<tr>
<td><code>&lt;leader&gt;p</code></td>
<td>生成函数实现</td>
</tr>
<tr>
<td><code>&lt;leader&gt;w</code></td>
<td>单词跳转</td>
</tr>
<tr>
<td><code>&lt;leader&gt;f</code></td>
<td>搜索~目录下的文件</td>
</tr>
<tr>
<td><code>&lt;leader&gt;F</code></td>
<td>搜索当前目录下的文本</td>
</tr>
<tr>
<td><code>&lt;leader&gt;g</code></td>
<td>显示git仓库提交记录</td>
</tr>
<tr>
<td><code>&lt;leader&gt;G</code></td>
<td>显示当前文件提交记录</td>
</tr>
<tr>
<td><code>&lt;leader&gt;gg</code></td>
<td>显示当前文件在某个commit下的完整内容</td>
</tr>
<tr>
<td><code>&lt;leader&gt;ff</code></td>
<td>语法错误自动修复(FixIt)</td>
</tr>
<tr>
<td><code>&lt;c-p&gt;</code></td>
<td>切换到上一个buffer</td>
</tr>
<tr>
<td><code>&lt;c-n&gt;</code></td>
<td>切换到下一个buffer</td>
</tr>
<tr>
<td><code>&lt;leader&gt;d</code></td>
<td>删除当前buffer</td>
</tr>
<tr>
<td><code>&lt;leader&gt;D</code></td>
<td>删除当前buffer外的所有buffer</td>
</tr>
<tr>
<td><code>vim</code></td>
<td>运行vim编辑器时,默认启动开始页面</td>
</tr>
<tr>
<td><code>&lt;F5&gt;</code></td>
<td>显示语法错误提示窗口</td>
</tr>
<tr>
<td><code>&lt;F9&gt;</code></td>
<td>显示上一主题</td>
</tr>
<tr>
<td><code>&lt;F10&gt;</code></td>
<td>显示下一主题</td>
</tr>
<tr>
<td><code>&lt;leader&gt;l</code></td>
<td>按竖线对齐</td>
</tr>
<tr>
<td><code>&lt;leader&gt;=</code></td>
<td>按等号对齐</td>
</tr>
<tr>
<td><code>Ya</code></td>
<td>复制行文本到字母a</td>
</tr>
<tr>
<td><code>Da</code></td>
<td>剪切行文本到字母a</td>
</tr>
<tr>
<td><code>Ca</code></td>
<td>改写行文本到字母a</td>
</tr>
<tr>
<td><code>rr</code></td>
<td>替换文本</td>
</tr>
<tr>
<td><code>&lt;leader&gt;r</code></td>
<td>全局替换，目前只支持单个文件</td>
</tr>
<tr>
<td><code>rev</code></td>
<td>翻转当前光标下的单词或使用V模式选择的文本</td>
</tr>
<tr>
<td><code>gcc</code></td>
<td>注释代码</td>
</tr>
<tr>
<td><code>gcap</code></td>
<td>注释段落</td>
</tr>
<tr>
<td><code>vif</code></td>
<td>选中函数内容</td>
</tr>
<tr>
<td><code>dif</code></td>
<td>删除函数内容</td>
</tr>
<tr>
<td><code>cif</code></td>
<td>改写函数内容</td>
</tr>
<tr>
<td><code>vaf</code></td>
<td>选中函数内容（包括函数名 花括号）</td>
</tr>
<tr>
<td><code>daf</code></td>
<td>删除函数内容（包括函数名 花括号）</td>
</tr>
<tr>
<td><code>caf</code></td>
<td>改写函数内容（包括函数名 花括号）</td>
</tr>
<tr>
<td><code>fa</code></td>
<td>查找字母a，然后再按f键查找下一个</td>
</tr>
<tr>
<td><code>&lt;leader&gt;e</code></td>
<td>快速编辑~&#x2F;.vimrc文件</td>
</tr>
<tr>
<td><code>&lt;leader&gt;s</code></td>
<td>重新加载~&#x2F;.vimrc文件</td>
</tr>
<tr>
<td><code>&lt;leader&gt;vp</code></td>
<td>快速编辑~&#x2F;.vimrc.custom.plugins文件</td>
</tr>
<tr>
<td><code>&lt;leader&gt;vc</code></td>
<td>快速编辑~&#x2F;.vimrc.custom.config文件</td>
</tr>
<tr>
<td><code>&lt;leader&gt;h</code></td>
<td>打开vimplus帮助文档</td>
</tr>
<tr>
<td><code>&lt;leader&gt;H</code></td>
<td>打开当前光标所在单词的vim帮助文档</td>
</tr>
<tr>
<td><code>&lt;leader&gt;&lt;leader&gt;t</code></td>
<td>生成try-catch代码块</td>
</tr>
<tr>
<td><code>&lt;leader&gt;&lt;leader&gt;y</code></td>
<td>复制当前选中到系统剪切板</td>
</tr>
<tr>
<td><code>&lt;leader&gt;&lt;leader&gt;i</code></td>
<td>安装插件</td>
</tr>
<tr>
<td><code>&lt;leader&gt;&lt;leader&gt;u</code></td>
<td>更新插件</td>
</tr>
<tr>
<td><code>&lt;leader&gt;&lt;leader&gt;c</code></td>
<td>删除插件</td>
</tr>
</tbody></table>
<h3 id="GCC"><a href="#GCC" class="headerlink" title="GCC"></a>GCC</h3><p>GCC 是 Linux 操作系统的编译工具集，是 GNU Compiler Collection 的缩写，包含 gcc，g++ 等编译器。这个工具集不仅包含编译器，还包含其他工具集，如 ar、nm 等。支持 X86、ARM、PowerPC、mips 等硬件平台，还支持 Linux、Windows 等软件平台。</p>
<h4 id="安装-GCC"><a href="#安装-GCC" class="headerlink" title="安装 GCC"></a>安装 GCC</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#ubuntu</span>
<span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> gcc g++

gcc <span class="token parameter variable">-v</span>
gcc <span class="token parameter variable">--version</span>

g++ <span class="token parameter variable">-v</span>
g++ <span class="token parameter variable">--version</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="GCC-工作流程"><a href="#GCC-工作流程" class="headerlink" title="GCC 工作流程"></a>GCC 工作流程</h4><p>GCC 编译程序分为 4 个阶段：预处理（预编译）、编译和优化、汇编和链接。</p>
<ol>
<li><p>预处理：GCC 调用预处理器来完成，包括：展开头文件、宏替换和去掉注释行。</p>
</li>
<li><p>编译：GCC 调用编译器对文件进行编译，得到一个汇编文件。</p>
</li>
<li><p>汇编：GCC 调用汇编器对文件进行汇编，最终得到一个二进制文件。</p>
</li>
<li><p>链接：GCC 调用链接器对程序需要调用的库进行链接，最终得到一个可执行的二进制文件。</p>
</li>
</ol>
<p>各个阶段的的文件</p>
<ul>
<li><p>源文件，后缀为 .c</p>
</li>
<li><p>预处理后的 C 文件，后缀为 .i，预处理参数为 -E</p>
</li>
<li><p>编译得到汇编语言的源文件，后缀为 .s，编译参数为 -S</p>
</li>
<li><p>汇编得到的二进制文件，后缀为 .o，汇编参数 -c</p>
</li>
</ul>
<p>C语言源文件 – 预处理 –&gt; 预处理后的文件 – 编译 –&gt; 汇编文件 – 汇编 –&gt; 目标文件 – 链接 –&gt; 可执行程序</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// 假设程序对应的源文件名为 test.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"array[%d] = %d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1. 预处理，-o 指定生成的文件名</span>
gcc <span class="token parameter variable">-E</span> test.c <span class="token parameter variable">-o</span> test.i

<span class="token comment"># 2. 编译，得到汇编文件</span>
gcc <span class="token parameter variable">-S</span> test.i <span class="token parameter variable">-o</span> test.s

<span class="token comment"># 3. 汇编</span>
gcc <span class="token parameter variable">-c</span> test.s <span class="token parameter variable">-o</span> test.o

<span class="token comment"># 4. 链接</span>
gcc test.o <span class="token parameter variable">-o</span> <span class="token builtin class-name">test</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注：在使用 gcc 编译程序的时候可以通过参数控制内部自动执行几个步骤</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 参数 -c 是进行文件的汇编，汇编之前的两步会自动执行</span>
gcc test.c <span class="token parameter variable">-c</span> <span class="token parameter variable">-o</span> app.o

<span class="token comment"># 该命令是直接进行链接生成可执行程序，链接之前的三步会自动执行</span>
gcc test.c <span class="token parameter variable">-o</span> app<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="GCC-常用参数"><a href="#GCC-常用参数" class="headerlink" title="GCC 常用参数"></a>GCC 常用参数</h4><p>注：下面的参数在 gcc 命令中没有位置要求</p>
<table>
<thead>
<tr>
<th align="center">gcc 编译选项</th>
<th align="center">选项的意义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">-E</td>
<td align="center">预处理指定的源文件，不进行编译</td>
</tr>
<tr>
<td align="center">-S</td>
<td align="center">编译指定的源文件，不进行汇编</td>
</tr>
<tr>
<td align="center">-c</td>
<td align="center">汇编指定的源文件，不进行链接</td>
</tr>
<tr>
<td align="center">-o file1 file2 &#x2F; file2 -o file1</td>
<td align="center">将 file2 编译成 file1</td>
</tr>
<tr>
<td align="center">-I directory</td>
<td align="center">指定 include 包含文件的搜索目录</td>
</tr>
<tr>
<td align="center">-g</td>
<td align="center">在编译的时候，生成调试信息，该程序可以被调试器调试</td>
</tr>
<tr>
<td align="center">-D</td>
<td align="center">编译程序的时候，指定一个宏</td>
</tr>
<tr>
<td align="center">-w</td>
<td align="center">不生成任何警告信息</td>
</tr>
<tr>
<td align="center">-Wall</td>
<td align="center">生成所有的警告信息</td>
</tr>
<tr>
<td align="center">-On</td>
<td align="center">n的取值范围：0～3。编译器的优化选项一共有 4 个级别，-O0 表示没有优化，-O1 为缺省值，-O3 优化级别最高</td>
</tr>
<tr>
<td align="center">-l</td>
<td align="center">在编译程序的时候，指定使用的库</td>
</tr>
<tr>
<td align="center">-L</td>
<td align="center">在编译程序的时候，搜索的库的路径</td>
</tr>
<tr>
<td align="center">-fPIC&#x2F;fpic</td>
<td align="center">生成与位置无关的代码</td>
</tr>
<tr>
<td align="center">shared</td>
<td align="center">生成共享目标文件，通常用在建立共享库的时候</td>
</tr>
<tr>
<td align="center">-std</td>
<td align="center">指定 C 方言，如: -std&#x3D;c99, gcc 默认的方言是 GNU C</td>
</tr>
</tbody></table>
<h4 id="指定生成的文件名（-o"><a href="#指定生成的文件名（-o" class="headerlink" title="指定生成的文件名（ -o )"></a>指定生成的文件名（ -o )</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># test.c 写在 -o 之前</span>
gcc test.c <span class="token parameter variable">-o</span> app

<span class="token comment"># test.c 写在 -o 之后</span>
gcc <span class="token parameter variable">-o</span> app test.c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="搜索头文件（-I-）"><a href="#搜索头文件（-I-）" class="headerlink" title="搜索头文件（ -I ）"></a>搜索头文件（ -I ）</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 假设头文件 head.h 在 include 目录中</span>
<span class="token comment"># 通过 -I 重新指定头文件的位置</span>
gcc *.c <span class="token parameter variable">-o</span> calc <span class="token parameter variable">-I</span> ./include<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="指定一个宏（-D-）"><a href="#指定一个宏（-D-）" class="headerlink" title="指定一个宏（ -D ）"></a>指定一个宏（ -D ）</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// test.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NUMBER</span>  <span class="token expression"><span class="token number">3</span></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">DEBUG</span></span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"我是一个程序猿, 我不会爬树...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>NUMBER<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"hello, GCC!!!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 在编译命令中定义这个 DEBUG 宏, </span>
$ gcc test.c <span class="token parameter variable">-o</span> app <span class="token parameter variable">-D</span> DEBUG

<span class="token comment"># 执行生成的程序， 可以看到程序第 9 行的输出</span>
$ ./app 
我是一个程序猿, 我不会爬树<span class="token punctuation">..</span>.
hello, GCC<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>
hello, GCC<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>
hello, GCC<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>-D 参数控制是否打印 log。</p>
<h4 id="多文件编译"><a href="#多文件编译" class="headerlink" title="多文件编译"></a>多文件编译</h4><ul>
<li>头文件</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_STRING_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_STRING_H_</span></span>
<span class="token keyword">int</span> <span class="token function">strLength</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span><span class="token comment">//_STRING_H_</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>源文件 string.c</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"string.h"</span></span>

<span class="token keyword">int</span> <span class="token function">strLength</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span>string<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>string<span class="token operator">++</span> <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span> <span class="token comment">// 当 *string 的值为 '\0' 时，停止计算</span>
    <span class="token punctuation">&#123;</span>
        len<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> len<span class="token punctuation">;</span> <span class="token comment">//返回字符串长度</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>源文件 main.c</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"string.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>src <span class="token operator">=</span> <span class="token string">"Hello, I'am Monkey!!!"</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"string length is: %d\n"</span><span class="token punctuation">,</span> <span class="token function">strLength</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>因为头文件是包含在源文件中的，因此在使用 gcc 编译程序的时候不需要指定头文件的名字。</p>
<ul>
<li>直接链接生成可执行程序</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 直接生成可执行程序 test</span>
gcc <span class="token parameter variable">-o</span> <span class="token builtin class-name">test</span> string.c main.c

<span class="token comment"># 运行可执行程序</span>
./test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>先将源文件汇编成目标文件，然后链接得到可执行程序</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 汇编生成二进制目标文件，指定了 -c 参数之后，源文件会自动生成 string.o 和 main.o</span>
gcc <span class="token parameter variable">-c</span> string.c main.c

<span class="token comment"># 链接目标文件，生成可执行程序 test</span>
gcc <span class="token parameter variable">-o</span> <span class="token builtin class-name">test</span> string.o main.o

<span class="token comment"># 运行可执行程序</span>
./test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="GCC-与-G"><a href="#GCC-与-G" class="headerlink" title="GCC 与 G++"></a>GCC 与 G++</h4><ol>
<li><p>在编译阶段（第二个阶段）：</p>
<ul>
<li><p>后缀为 .c 的文件，gcc 把它当作是 C 程序，g++ 把它当作是 C++ 程序。</p>
</li>
<li><p>后缀为 .cpp 的文件，两者都会认为是 C++ 程序。</p>
</li>
<li><p>g++ 会调用 gcc，对于 C++ 程序，两者是等价的。</p>
</li>
</ul>
</li>
<li><p>在链接阶段（最后一个阶段）：</p>
<ul>
<li><p>gcc 和 g++ 都可以自动链接到标准 C 库。</p>
</li>
<li><p>g++ 可以自动链接到标准 C++ 库，gcc 需要加参数 -lstdc++</p>
</li>
</ul>
</li>
<li><p>__cplusplus 宏的定义</p>
<ul>
<li><p>g++ 会自动定义 __cplusplus 宏，但不影响编译 C 程序。</p>
</li>
<li><p>gcc 会根据文件后缀名判断是否定义 __cplusplus 宏</p>
</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 编译 C 程序</span>
gcc test.c <span class="token parameter variable">-o</span> <span class="token builtin class-name">test</span>
g++ test.c <span class="token parameter variable">-o</span> <span class="token builtin class-name">test</span>

<span class="token comment"># 编译 C++ 程序</span>
gcc test.cpp -lstdc++ <span class="token parameter variable">-o</span> <span class="token builtin class-name">test</span>
g++ test.cpp <span class="token parameter variable">-o</span> <span class="token builtin class-name">test</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="静态链接库和动态链接库"><a href="#静态链接库和动态链接库" class="headerlink" title="静态链接库和动态链接库"></a>静态链接库和动态链接库</h3><p>库文件包括静态链接库和动态链接库，使用库的目的：</p>
<ol>
<li><p>为了使程序更简洁不需要在项目中维护太多的源文件。</p>
</li>
<li><p>为了源代码保密。</p>
</li>
</ol>
<h4 id="静态链接库"><a href="#静态链接库" class="headerlink" title="静态链接库"></a>静态链接库</h4><p>静态链接库命名规则：</p>
<ul>
<li><p>Linux 操作系统：以 lib 作为前缀，以 .a 作为后缀，中间是库的名字，即：libxxx.a。</p>
</li>
<li><p>Windows 操作系统：以 lib 作为前缀，以 .lib 作为后缀，中间是库的名字，即：libxxx.lib。</p>
</li>
</ul>
<h4 id="生成静态链接库"><a href="#生成静态链接库" class="headerlink" title="生成静态链接库"></a>生成静态链接库</h4><p>生成静态链接库需要先对源文件进行汇编操作得到二进制格式的目标文件，然后通过 ar 将目标文件打包得到静态库文件。</p>
<p>ar 的参数：</p>
<ul>
<li><p>c: 创建一个库，不管库是否存在，都将创建。</p>
</li>
<li><p>s: 创建目标文件索引，在创建较大的库时能加快时间。</p>
</li>
<li><p>r: 在库中插入模块（替换），默认新的成员添加在库的结尾处，如果模块名已经在库中存在，则替换同名的模块。</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1. 将源文件进行汇编，得到 .o 文件，需要使用参数 -c</span>
gcc 源文件（*.c） <span class="token parameter variable">-c</span>

<span class="token comment"># 2. 将得到的 .o 进行打包，得到静态链接库</span>
ar rcs 静态链接库的名字（libxxx.a） 原材料（*.o）

<span class="token comment"># 3. 发布静态链接库</span>
<span class="token comment"># 提供头文件 *.h 和 静态链接库 libxxx.a</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="准备测试程序"><a href="#准备测试程序" class="headerlink" title="准备测试程序"></a>准备测试程序</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 目录结构 add.c div.c mult.c sub.c -> 算法的源文件, 函数声明在头文件 head.h</span>
<span class="token comment"># main.c中是对接口的测试程序, 制作库的时候不需要将 main.c 算进去</span>
<span class="token builtin class-name">.</span>
├── add.c
├── div.c
├── include
│   └── head.h
├── main.c
├── mult.c
└── sub.c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>add.c</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>sub.c</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token keyword">int</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> a<span class="token operator">-</span>b<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>mult.c</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token keyword">int</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> a<span class="token operator">*</span>b<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>div.c</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token keyword">double</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>a<span class="token operator">/</span>b<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>head.h</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_HEAD_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_HEAD_H</span></span>
<span class="token comment">// 加法</span>
<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 减法</span>
<span class="token keyword">int</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 乘法</span>
<span class="token keyword">int</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 除法</span>
<span class="token keyword">double</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>main.c</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d, b = %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a + b = %d\n"</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a - b = %d\n"</span><span class="token punctuation">,</span> <span class="token function">subtract</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a * b = %d\n"</span><span class="token punctuation">,</span> <span class="token function">multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a / b = %f\n"</span><span class="token punctuation">,</span> <span class="token function">divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="生成静态链接库-1"><a href="#生成静态链接库-1" class="headerlink" title="生成静态链接库"></a>生成静态链接库</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 将源文件 add.c, div.c, mult.c, sub.c 进行汇编，得到二进制目标文件 add.o, div.o, mult.o, sub.o</span>
gcc add.c div.c mult.c sub.c <span class="token parameter variable">-c</span> <span class="token parameter variable">-I</span> ./include/

<span class="token comment"># 将生成的目标文件通过 ar 打包生成静态链接库</span>
ar rcs libcalc.a *.o

<span class="token comment"># 发布静态库</span>
<span class="token comment"># head.h 和 libcalc.a</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="静态链接库的使用"><a href="#静态链接库的使用" class="headerlink" title="静态链接库的使用"></a>静态链接库的使用</h4><p>将静态链接库、头文件和测试程序放到一个目录中准备进行测试。</p>
<ul>
<li><p>-L: 指定静态链接库所在的目录（相对或者绝对路径）</p>
</li>
<li><p>-l: 指定库的名字，需要掐头（lib）去尾（.a），剩下的才是需要的静态链接库的名字</p>
</li>
<li><p>-L -l: 参数和参数值之间可以有空格，也可以没有 -L.&#x2F; -lcalc</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc main.c <span class="token parameter variable">-o</span> app <span class="token parameter variable">-L</span> ./ <span class="token parameter variable">-l</span> calc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="动态链接库"><a href="#动态链接库" class="headerlink" title="动态链接库"></a>动态链接库</h4><p>动态链接库是程序运行时加载的库，当动态链接库正确部署之后，运行的多个程序可以使用同一个加载到内存中的动态链接库，因此在 Linux 操作系统中动态链接库又被称为共享库。</p>
<p>动态链接库是目标文件的集合，库中的函数和变量的地址是相对地址，而静态链接库中使用的是绝对地址。动态链接库的真实地址是在应用程序加载动态链接库时形成的。</p>
<p>动态链接库的命名规则：</p>
<ul>
<li><p>Linux 操作系统：以 lib 作为前缀，以 .so 作为后缀，中间是库的名字，即：libxxx.so。</p>
</li>
<li><p>Windows 操作系统：以 lib 作为前缀，以 .dll 作为后缀，中间是库的名字，即：libxxx.dll。</p>
</li>
</ul>
<h4 id="生成动态链接库"><a href="#生成动态链接库" class="headerlink" title="生成动态链接库"></a>生成动态链接库</h4><p>生成动态链接库是使用的 gcc 命令。</p>
<ul>
<li><p>-fPIC 或 -fpic: 使 gcc 生成的代码与位置无关，也就是使用相对位置。</p>
</li>
<li><p>-shared: 使编译器生成一个动态链接库。</p>
</li>
</ul>
<p>生成动态链接库的具体步骤</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1. 将源文件进行汇编操作，添加额外参数 -fpic/-fPIC</span>
gcc 源文件（*.c） <span class="token parameter variable">-c</span> <span class="token parameter variable">-fpic</span>

<span class="token comment"># 2. 将得到的 .o 文件打包成动态链接库，使用 -shared 参数指定生成动态链接库</span>
gcc <span class="token parameter variable">-shared</span> *.o <span class="token parameter variable">-o</span> 动态链接库

<span class="token comment"># 3. 发布动态链接库和头文件</span>
<span class="token comment"># xxx.h 和 libxxx.so</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="动态链接库制作举例"><a href="#动态链接库制作举例" class="headerlink" title="动态链接库制作举例"></a>动态链接库制作举例</h4><p>使用上面制作静态链接库的源代码来制作动态链接库。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1. 将 .c 文件汇编成 .o 文件，额外的参数 -fpic/-fPIC</span>
gcc add.c div.c mult.c sub.c <span class="token parameter variable">-c</span> <span class="token parameter variable">-fpic</span> <span class="token parameter variable">-I</span> ./include/

<span class="token comment"># 2. 使用 gcc 将得到的目标文件打包生成动态链接库，额外参数 -shared</span>
gcc <span class="token parameter variable">-shared</span> add.o div.o mult.o sub.o <span class="token parameter variable">-o</span> libcalc.so

<span class="token comment"># 发布动态链接库和相关的头文件</span>
<span class="token comment"># head.h 和 libcalc.so</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="动态链接库的使用"><a href="#动态链接库的使用" class="headerlink" title="动态链接库的使用"></a>动态链接库的使用</h4><p>将动态链接库、头文件和测试程序放到一个目录中准备进行测试。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 编译时，需要指定动态链接库的相关信息：库的路径 -L，库的名字 -l</span>
gcc main.c <span class="token parameter variable">-o</span> app -L./ <span class="token parameter variable">-lcalc</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="库的工作原理"><a href="#库的工作原理" class="headerlink" title="库的工作原理"></a>库的工作原理</h4><ul>
<li><p>静态链接库在链接阶段被打包到可执行程序中，当可执行程序被执行，静态链接库中的代码会一并加载到内存中。</p>
</li>
<li><p>动态链接库虽然链接阶段也指定了库路径和库名字，但是动态链接库并没有被打包到可执行程序中，只是检查了一下库文件是否存在和在可执行程序中记录了一下库的名字。程序执行的时候会先检测需要的动态链接库是否可以被加载。当动态链接库中函数被调用了，这时动态链接库才被加载到内存，如果不调用则不加载。动态链接库的检测和内存加载等操作都是由动态链接器来完成的。</p>
</li>
</ul>
<h4 id="动态链接器"><a href="#动态链接器" class="headerlink" title="动态链接器"></a>动态链接器</h4><p>动态链接器是一个独立于应用程序的进程，属于操作系统，它内部有一个动态链接库的搜索顺序。优先级从高到低分别是：</p>
<ol>
<li><p>可执行文件内部的 DT_RPATH 段</p>
</li>
<li><p>系统的环境变量 LD_LIBRARY_PATH</p>
</li>
<li><p>系统动态链接库的缓存文件 &#x2F;etc&#x2F;ld.so.cache</p>
</li>
<li><p>存储动态链接库 &#x2F; 静态库的系统目录 &#x2F;lib&#x2F;，&#x2F;usr&#x2F;lib&#x2F; 等</p>
</li>
</ol>
<h4 id="加载动态链接库的解决方案"><a href="#加载动态链接库的解决方案" class="headerlink" title="加载动态链接库的解决方案"></a>加载动态链接库的解决方案</h4><p>方案 1 : 将动态链接库的路径添加到环境变量 LD_LIBRARY_PATH 中</p>
<ol>
<li><p>配置文件</p>
<ul>
<li><p>用户级别：~&#x2F;.bashrc，对当前用户有效</p>
</li>
<li><p>系统级别：&#x2F;etc&#x2F;profile，设置对所有用户有效</p>
</li>
</ul>
</li>
<li><p>在配置文件的最后添加</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span><span class="token variable">$LD_LIBRARY_PATH</span>:动态库的绝对路径<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="3">
<li><p>配置文件生效</p>
<ul>
<li><p>修改了用户级别的配置文件，关闭当前终端，重新打开一个新终端就能生效了</p>
</li>
<li><p>修改了系统级别的配置文件，注销或者关闭系统，再开机配置就能生效了</p>
</li>
<li><p>也可以执行下面的命令让配置文件被重新加载</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># source 简写 .，会让文件内容被重新加载</span>
<span class="token builtin class-name">source</span> ~/.bashrc
<span class="token builtin class-name">source</span> /etc/profile

<span class="token builtin class-name">.</span> ~/.bashrc
<span class="token builtin class-name">.</span> /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p>方案 2 ：更新 &#x2F;etc&#x2F;ld.so.cache 文件</p>
<ol>
<li><p>找到动态链接库的绝对路径（不包括库的名字）</p>
</li>
<li><p>修改 &#x2F;etc&#x2F;ld.so.conf 文件，添加动态链接库的绝对路径（不包括库的名字），独占一行</p>
</li>
<li><p>更新 &#x2F;etc&#x2F;ld.so.conf 文件中的数据到 &#x2F;etc&#x2F;ld.so.cache 文件中</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ldconfig <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>方案 3 ：拷贝动态链接库文件到系统库目录 &#x2F;lib&#x2F; 或者 &#x2F;usr&#x2F;lib&#x2F; 中，也可以将动态链接库的软链接文件放进去</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 库拷贝</span>
<span class="token function">sudo</span> <span class="token function">cp</span> /xxx/xxx/libxxx.so /usr/lib

<span class="token comment"># 创建软链接</span>
<span class="token function">sudo</span> <span class="token function">ln</span> <span class="token parameter variable">-s</span> /xxx/xxx/libxxx.so /usr/lib/libxxx.so<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>验证：ldd 命令可以检测程序是否能够通过动态链接器加载到对应的动态链接库</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ldd 可执行程序的名字

<span class="token comment"># 例子</span>
ldd app<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="静态链接库的优缺点"><a href="#静态链接库的优缺点" class="headerlink" title="静态链接库的优缺点"></a>静态链接库的优缺点</h4><ul>
<li><p>优点:</p>
<ul>
<li><p>静态链接库被打包到应用程序中，加载速度快</p>
</li>
<li><p>发布程序无需提供静态链接库，移植方便</p>
</li>
</ul>
</li>
<li><p>缺点</p>
<ul>
<li><p>相同的库文件可能在内存中被加载多份，浪费内存</p>
</li>
<li><p>库文件更新需要重新编译项目文件，浪费时间</p>
</li>
</ul>
</li>
</ul>
<h4 id="动态链接库的优缺点"><a href="#动态链接库的优缺点" class="headerlink" title="动态链接库的优缺点"></a>动态链接库的优缺点</h4><ul>
<li><p>优点：</p>
<ul>
<li><p>可以实现不同进程间的资源共享，动态链接库在内存中只存在一份拷贝，避免了静态链接库的浪费内存的问题</p>
</li>
<li><p>动态链接库升级简单，只需要替换库文件，无需重新编译项目文件</p>
</li>
<li><p>可以控制加载动态链接库的时机，不调用库函数动态链接库不会被加载</p>
</li>
</ul>
</li>
<li><p>缺点：</p>
<ul>
<li><p>加载速度比静态链接库慢，现代计算机的性能可以忽略不计</p>
</li>
<li><p>发布程序需要提供依赖的动态链接库</p>
</li>
</ul>
</li>
</ul>
<h3 id="cc-和-gcc"><a href="#cc-和-gcc" class="headerlink" title="cc 和 gcc"></a>cc 和 gcc</h3><p>cc 是来自 Unix 操作系统的 c 语言编译器，是 c compiler 的缩写。gcc 是来自 Linux 操作系统，是 GNU compiler collection 的缩写，它是一个编译器集合。</p>
<p>在 Linux 操作系统，cc 是 gcc 的一个软链接。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>base<span class="token punctuation">)</span> lyfubuntu@lyfubuntu:~$ <span class="token function">which</span> cc
/usr/bin/cc
<span class="token punctuation">(</span>base<span class="token punctuation">)</span> lyfubuntu@lyfubuntu:~$ <span class="token function">ls</span> <span class="token parameter variable">-la</span> /usr/bin/cc
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">20</span> <span class="token number">11</span>月 <span class="token number">28</span> <span class="token number">16</span>:36 /usr/bin/cc -<span class="token operator">></span> /etc/alternatives/cc
<span class="token punctuation">(</span>base<span class="token punctuation">)</span> lyfubuntu@lyfubuntu:~$ <span class="token function">ls</span> <span class="token parameter variable">-la</span> /etc/alternatives/cc
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">12</span> <span class="token number">11</span>月 <span class="token number">28</span> <span class="token number">16</span>:36 /etc/alternatives/cc -<span class="token operator">></span> /usr/bin/gcc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注：这样的主要原因是 Unix 操作系统是付费系统，这样做能够保证 makefile 在两个系统能兼容。下面就开始介绍 makefile 了。</p>
<h3 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h3><p>make 是一个命令工具，是一个解释 makefile 中指令的命令工具，makefile 定义了整个工程项目文件的编译规则，实现了”自动化编译“。当 makefile 编写完成后，只需要运行 make 命令，整个工程将完全自动编译，极大的提高了软件开发效率。</p>
<p>makefile 文件名可以命名为 makefile 和 Makefile 两种方式。构建项目的时候在哪个目录下执行构建命令 make ，这个目录下的 makefile 文件就会被加载。一个项目中可以有很多个位于不同目录的 makefile 文件。</p>
<h4 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h4><p>makefile 是由规则构成的，make 命令其实就是通过解析 makefile 的规则并运行它们实现自动化编译工作的。</p>
<p>注意：Makefile 中的缩进是制表符而不是空格符。</p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 规则的语法格式:</span>
<span class="token target symbol">target1,target2...</span><span class="token punctuation">:</span> depend1, depend2, ...
	command
	......
	......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>每条规则由三个部分组成：目标（target），依赖（depend）和命令（command）。</p>
<ul>
<li><p>命令（command）:规则需要执行的动作。</p>
<ul>
<li><p>如：编译，进入目录等 shell 命令。</p>
</li>
<li><p>动作可以有多个，每条命令前必须有有一个 Tab 缩进并且独占一行。</p>
</li>
</ul>
</li>
<li><p>依赖（depend）：规则所必需的依赖条件。</p>
<ul>
<li><p>如：生成可执行程序的目标文件。</p>
</li>
<li><p>如果规则的命令不需要任何依赖，那么规则的依赖可以为空。</p>
</li>
<li><p>当前规则中的依赖可以是其他规则中的目标，这样就形成了规则间的嵌套。</p>
</li>
<li><p>依赖可以有多个。</p>
</li>
</ul>
</li>
<li><p>目标（target）：</p>
<ul>
<li><p>通过规则中的命令，可以生成一个和目标同名的文件。</p>
</li>
<li><p>命令可以有多个，因此目标也可以有多个。</p>
</li>
<li><p>可以只执行动作，不生成目标，这样的目标被称为伪目标。</p>
</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 源文件 a.c b.c c.c ，头文件 head.h，生成的可执行程序 app</span>

<span class="token comment"># example 1</span>
<span class="token target symbol">app</span><span class="token punctuation">:</span>a.c b.c c.c
  gcc a.c b.c c.c -o app

<span class="token comment"># example 2</span>
<span class="token target symbol">app,app1</span><span class="token punctuation">:</span>a.c b.c c.c
  gcc a.c b.c -o app
  gcc c.c -o app1

<span class="token comment"># example 3</span>
<span class="token target symbol">app</span><span class="token punctuation">:</span>a.o b.o c.o
  gcc a.o b.o c.o -o app

<span class="token target symbol">a.o</span><span class="token punctuation">:</span>a.c
  gcc -c a.c

<span class="token target symbol">b.o</span><span class="token punctuation">:</span>b.c
  gcc -c b.c

<span class="token target symbol">c.o</span><span class="token punctuation">:</span>c.c
  gcc -c c.c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="规则的执行"><a href="#规则的执行" class="headerlink" title="规则的执行"></a>规则的执行</h4><p>make 命令编译程序的时候，首先找到 makefile 文件中的第一个规则，分析并执行相关动作。如果该动作的依赖不存在，这个动作就不会被执行。因此可以通过添加新的规则，将这个依赖生成出来。当第一个规则的所有依赖都已经生成出来了，这时第一条规则将被执行生成对应的目标，这时 make 命令任务就完成了。</p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 规则之间的嵌套</span>
<span class="token comment"># 规则 1 </span>
<span class="token target symbol">app</span><span class="token punctuation">:</span>a.o b.o c.o
  gcc a.o b.o c.o -o app

<span class="token comment"># 规则 2</span>
<span class="token target symbol">a.o</span><span class="token punctuation">:</span>a.c
  gcc -c a.c

<span class="token comment"># 规则 3</span>
<span class="token target symbol">b.o</span><span class="token punctuation">:</span>b.c
  gcc -c b.c

<span class="token comment"># 规则 4</span>
<span class="token target symbol">c.o</span><span class="token punctuation">:</span>c.c
  gcc -c c.c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面的例子中由于第一条规则的依赖不存在，因此需要先执行第二、第三、第四条规则生成第一条规则的依赖，当第一条规则的依赖全部生成，这时将执行第一条规则，然后 make 命令执行完毕。</p>
<p>如果想要执行 makefile 中的非第一条规则，需要执行 <code>make 想要执行的规则的目标</code>，如执行上面例子的第三条规则，需要执行 <code>make b.o</code></p>
<h4 id="文件的时间辍"><a href="#文件的时间辍" class="headerlink" title="文件的时间辍"></a>文件的时间辍</h4><p>make 命令会根据文件的时间戳判定是否执行 makefile 中相关规则的命令。</p>
<ul>
<li><p>当目标时间戳 &gt; 所有依赖的时间戳，这时 make 命令将不会执行这条规则。</p>
</li>
<li><p>当目标时间戳 &lt; 某些依赖的时间戳，这时 make 命令将会执行这条规则。</p>
</li>
<li><p>当规则中目标文件不存在，那么 make 会执行这条规则。</p>
</li>
</ul>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 规则之间的嵌套</span>
<span class="token comment"># 规则 1 </span>
<span class="token target symbol">app</span><span class="token punctuation">:</span>a.o b.o c.o
  gcc a.o b.o c.o -o app

<span class="token comment"># 规则 2</span>
<span class="token target symbol">a.o</span><span class="token punctuation">:</span>a.c
  gcc -c a.c

<span class="token comment"># 规则 3</span>
<span class="token target symbol">b.o</span><span class="token punctuation">:</span>b.c
  gcc -c b.c

<span class="token comment"># 规则 4</span>
<span class="token target symbol">c.o</span><span class="token punctuation">:</span>c.c
  gcc -c c.c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面例子中，当执行过一次 make 命令后，修改 a.c 文件，这时再通过 make 命令编译项目，会先执行规则 2 更新目标文件 a.o，然后执行规则 1 更新目标文件 app，其余规则是不会被执行。</p>
<h4 id="自动推导"><a href="#自动推导" class="headerlink" title="自动推导"></a>自动推导</h4><p>make 是一个功能强大的构建工具，它有自动推导的能力，不会完全依赖 makefile。如果 makefile 没有指出编译规则，make 会自动使用 cc -c 命令来编译 .c 源文件。makefile 只需要给出需要构建的目标文件名（.o 文件），make 会自动为这个 .o 文件寻找合适的依赖文件（对应的 .c 文件），使用 cc -c 命令来构建这个目标文件。</p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 目录中有 add.c div.c head.h main.c makefile mult.c sub.c 这几个文件</span>

<span class="token comment"># makefile 中只有下面一个规则</span>
<span class="token target symbol">calc</span><span class="token punctuation">:</span>add.o div.o main.o mult.o sub.o
  gcc add.o div.o main.o mult.o sub.o -o calc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>上面中的例子中，目录中并没有 .o 文件，也不存在其他规则生成 .o 文件。但是 make 会使用默认的构造规则生成这些依赖文件，最终生成目标文件 calc。</p>
<h4 id="自定义变量"><a href="#自定义变量" class="headerlink" title="自定义变量"></a>自定义变量</h4><p>makefile 用户可以自定义变量，这些变量是没有类型的。创建一个变量的时候一定要给它赋值。</p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 创建一个变量名并且给其赋值</span>
变量名<span class="token operator">=</span>变量值

<span class="token comment"># 取出变量的值</span>
<span class="token variable">$</span><span class="token punctuation">(</span>变量名<span class="token punctuation">)</span>

<span class="token comment"># example</span>
obj<span class="token operator">=</span>add.o div.o main.o mult.o sub.o
<span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 普通写法</span>
<span class="token target symbol">calc</span><span class="token punctuation">:</span>add.o div.o main.o mult.o sub.o
  gcc add.o div.o main.o mult.o sub.o -o calc

<span class="token comment"># 新写法</span>
obj<span class="token operator">=</span>add.o div.o main.o mult.o sub.o
target<span class="token operator">=</span>calc
<span class="token target symbol"><span class="token variable">$</span>(target)</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  gcc <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="预定义变量"><a href="#预定义变量" class="headerlink" title="预定义变量"></a>预定义变量</h4><p>makefile 中有一些预定义变量，用户可以直接使用这些变量。</p>
<p>常用的预定义变量</p>
<table>
<thead>
<tr>
<th align="center">变量名</th>
<th align="center">含义</th>
<th align="center">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">AR</td>
<td align="center">生成静态链接库的程序名称</td>
<td align="center">ar</td>
</tr>
<tr>
<td align="center">AS</td>
<td align="center">汇编编译器的名称</td>
<td align="center">as</td>
</tr>
<tr>
<td align="center">CC</td>
<td align="center">C 语言编译器的名称</td>
<td align="center">cc</td>
</tr>
<tr>
<td align="center">CPP</td>
<td align="center">C 语言预编译器的名称</td>
<td align="center">$(CC) -E</td>
</tr>
<tr>
<td align="center">CXX</td>
<td align="center">C++ 语言编译器的名称</td>
<td align="center">g++</td>
</tr>
<tr>
<td align="center">FC</td>
<td align="center">FORTRAN 语言编译器的名称</td>
<td align="center">f77</td>
</tr>
<tr>
<td align="center">RM</td>
<td align="center">删除文件程序的名称</td>
<td align="center">rm -f</td>
</tr>
<tr>
<td align="center">ARFLAGS</td>
<td align="center">生成静态链接库的选项</td>
<td align="center">无</td>
</tr>
<tr>
<td align="center">ASFLAGS</td>
<td align="center">汇编语言编译器的编译选项</td>
<td align="center">无</td>
</tr>
<tr>
<td align="center">CFLAGS</td>
<td align="center">C 语言编译器的编译选项</td>
<td align="center">无</td>
</tr>
<tr>
<td align="center">CPPFLAGS</td>
<td align="center">C 语言预编译器的编译选项</td>
<td align="center">无</td>
</tr>
<tr>
<td align="center">CXXFLAGS</td>
<td align="center">C++ 语言编译器的编译选项</td>
<td align="center">无</td>
</tr>
<tr>
<td align="center">FFLAGS</td>
<td align="center">FORTRAN 语言编译器的编译选项</td>
<td align="center">无</td>
</tr>
</tbody></table>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 普通写法</span>
<span class="token target symbol">calc</span><span class="token punctuation">:</span>add.o div.o main.o mult.o sub.o
  gcc add.o div.o main.o mult.o sub.o -o calc

<span class="token comment"># 新写法</span>
obj<span class="token operator">=</span>add.o div.o main.o mult.o sub.o
target<span class="token operator">=</span>calc
<span class="token comment"># 代码优化</span>
CFLAGS<span class="token operator">=</span>-O3
<span class="token target symbol"><span class="token variable">$</span>(target)</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="自动变量"><a href="#自动变量" class="headerlink" title="自动变量"></a>自动变量</h4><p>自动变量用来代表规则中的目标文件和依赖文件，只能再规则的命令中使用。</p>
<p>常见的自动变量</p>
<table>
<thead>
<tr>
<th align="center">变量</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$*</td>
<td align="center">表示目标文件的名称，不包含目标文件的扩展名</td>
</tr>
<tr>
<td align="center">$+</td>
<td align="center">表示所有的依赖文件，依赖文件之间以空格分开，按照出现的先后顺序，可能包含重复的依赖文件</td>
</tr>
<tr>
<td align="center">$&lt;</td>
<td align="center">依赖项中第一个依赖文件的名称</td>
</tr>
<tr>
<td align="center">$?</td>
<td align="center">依赖项中，所有比目标文件时间戳晚的依赖文件，依赖文件之间以空格分开</td>
</tr>
<tr>
<td align="center">$@</td>
<td align="center">表示目标文件的名称，包含文件扩展名</td>
</tr>
<tr>
<td align="center">$^</td>
<td align="center">依赖项中，所有不重复的依赖文件，以空格分开</td>
</tr>
</tbody></table>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 普通写法</span>
<span class="token target symbol">calc</span><span class="token punctuation">:</span>add.o div.o main.o mult.o sub.o
  gcc add.o div.o main.o mult.o sub.o -o calc

<span class="token comment"># 新写法</span>
<span class="token target symbol">calc</span><span class="token punctuation">:</span>add.o div.o main.o mult.o sub.o
  gcc <span class="token variable">$^</span> -o <span class="token variable">$@</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="模式匹配"><a href="#模式匹配" class="headerlink" title="模式匹配"></a>模式匹配</h4><pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">calc</span><span class="token punctuation">:</span>add.o div.o main.o mult.o sub.o
  gcc add.o div.o main.o mult.o sub.o -o calc

<span class="token target symbol">add.o</span><span class="token punctuation">:</span>add.c
  gcc add.c -c

<span class="token target symbol">div.o</span><span class="token punctuation">:</span>div.c
  gcc div.c -c

<span class="token target symbol">main.o</span><span class="token punctuation">:</span>main.c
  gcc main.c -c

<span class="token target symbol">sub.o</span><span class="token punctuation">:</span>sub.c
  gcc sub.c -c

<span class="token target symbol">mult.o</span><span class="token punctuation">:</span>mult.c
  gcc mult.c -c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以将上面例子中第二条规则到第六条规则改写成模板，使得 makefile 变得精简。</p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># % 是一个通配符，匹配的是文件名</span>
<span class="token comment"># 由于 % 对应的文件名实时变化，因此命令中的依赖必须使用自动变量</span>
<span class="token target symbol">%.o</span><span class="token punctuation">:</span>%.c
  gcc <span class="token variable">$&lt;</span> -c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="wildcard-函数"><a href="#wildcard-函数" class="headerlink" title="wildcard 函数"></a>wildcard 函数</h4><p>makefile 有很多函数，并且所有的函数都是有返回值的。函数的格式为 &#96;$(函数名 参数1,参数2,参数3,…)。</p>
<p>wildcard 函数：获取指定目录下指定类型的文件名，返回值：以空格分隔、指定目录下的所有符合条件的文件名列表。</p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># 该函数的参数只有一个，但是这个参数可以包含若干部分，以空格分隔</span>
<span class="token comment"># 参数：指定目录下指定类型的文件，如当前目录下的 .c 文件：*.c</span>
<span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">wildcard</span> PATTERN...<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>PATTERN: 某个或多个目录下的某种类型的文件，如当前目录下的 .c 文件可以写成 *.c。</p>
</li>
<li><p>可以指定多个路径，每个路径之间以空格分隔。</p>
</li>
<li><p>返回值：得到若干个文件的文件列表，文件名使用空格分隔</p>
</li>
</ul>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile">src<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">wildcard</span> *.c ./sub/*.c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="patsubst-函数"><a href="#patsubst-函数" class="headerlink" title="patsubst 函数"></a>patsubst 函数</h4><p>作用：按照指定的模式替换指定的文件名的后缀。</p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">patsubst</span> pattern,replacement,text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><p>pattern:指定要被替换的文件名中的后缀，文件名和路径不需要设置，使用 % 表示，需要指定出要被替换的后缀，如 %.c。</p>
</li>
<li><p>replacement:指定出替换成的后缀，依旧使用 % 表示，需要指定出替换成的后缀，如 %.o。</p>
</li>
<li><p>text:被替换的原始文件名。</p>
</li>
<li><p>返回值：替换完成的文件名字符串。</p>
</li>
</ul>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile">src<span class="token operator">=</span>a.cpp b.cpp c.cpp d.cpp
<span class="token comment"># 把变量 src 中的文件名的后缀从 .cpp 替换为 .o</span>
obj<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">patsubst</span> %.cpp, %.o, <span class="token variable">$</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="makefile-的编写"><a href="#makefile-的编写" class="headerlink" title="makefile 的编写"></a>makefile 的编写</h4><p>当前目录中有下面一些文件：<code>add.c</code>, <code>div.c</code>, <code>head.h</code>, <code>main.c</code>, <code>mult.c</code>, <code>sub.c</code>。</p>
<p><strong>version 1</strong></p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">calc</span><span class="token punctuation">:</span>add.c div.c main.c mult.c sub.c
  gcc add.c div.c main.c mult.c sub.c -o calc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>缺点：某一个源文件被修改，所有的源文件都需要重新编译。</p>
<p><strong>version 2</strong></p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">calc</span><span class="token punctuation">:</span>add.o div.o main.o mult.o sub.o
  gcc add.o div.o main.o mult.o sub.o -o calc

<span class="token target symbol">add.o</span><span class="token punctuation">:</span>add.c
  gcc add.c -c

<span class="token target symbol">div.o</span><span class="token punctuation">:</span>div.c
  gcc div.c -c

<span class="token target symbol">main.o</span><span class="token punctuation">:</span>main.c
  gcc main.c -c

<span class="token target symbol">sub.o</span><span class="token punctuation">:</span>sub.c
  gcc sub.c -c

<span class="token target symbol">mult.o</span><span class="token punctuation">:</span>mult.c
  gcc mult.c -c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>缺点：规则冗余，需要精简。</p>
<p><strong>version 3</strong></p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile">obj<span class="token operator">=</span>add.o div.o main.o mult.o sub.o
target<span class="token operator">=</span>calc

<span class="token target symbol"><span class="token variable">$</span>(target)</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  gcc <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>

<span class="token target symbol">%.o</span><span class="token punctuation">:</span>%.c
  gcc <span class="token variable">$&lt;</span> -c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>缺点：obj 值需要手动写出来。</p>
<p><strong>version 4</strong></p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile">src<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">wildcard</span> *.c<span class="token punctuation">)</span>
obj<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">patsubst</span> %.c, %.o, <span class="token variable">$</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span>
target<span class="token operator">=</span>calc

<span class="token target symbol"><span class="token variable">$</span>(target)</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  gcc <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>

<span class="token target symbol">%.o</span><span class="token punctuation">:</span>%.c
  gcc <span class="token variable">$&lt;</span> -c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>缺点：没有删除功能。</p>
<p><strong>version 5</strong></p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile">src<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">wildcard</span> *.c<span class="token punctuation">)</span>
obj<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">patsubst</span> %.c, %.o, <span class="token variable">$</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span>
target<span class="token operator">=</span>calc

<span class="token target symbol"><span class="token variable">$</span>(target)</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  gcc <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>

<span class="token target symbol">%.o</span><span class="token punctuation">:</span>%.c
  gcc <span class="token variable">$&lt;</span> -c

<span class="token target symbol">clean</span><span class="token punctuation">:</span>
  rm <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 删除 .o 文件和可执行程序</span>
<span class="token function">make</span> clean<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>缺点：当执行完 make 命令后，向目录中新建一个 clean 文件，这时根据 make 关于文件时间戳的更新规则，无法通过 make clean 命令删除 .o 文件和可执行程序文件文件。</p>
<p><strong>version 6</strong></p>
<p>make 命令不会对伪目标进行文件时间戳检测，相应规则中的命令每次都会被执行。</p>
<p>伪目标的语法：<code>.PHONY:伪文件名称</code>。</p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile">src<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">wildcard</span> *.c<span class="token punctuation">)</span>
obj<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">patsubst</span> %.c, %.o, <span class="token variable">$</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span>
target<span class="token operator">=</span>calc

<span class="token target symbol"><span class="token variable">$</span>(target)</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  gcc <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>

<span class="token target symbol">%.o</span><span class="token punctuation">:</span>%.c
  gcc <span class="token variable">$&lt;</span> -c

<span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span>clean
<span class="token target symbol">clean</span><span class="token punctuation">:</span>
  <span class="token comment"># - 表示强制执行这个指令，如果执行失败也不会终止，还会执行下面的命令</span>
  -rm <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 目录结构</span>
tree

<span class="token comment"># 输出结果</span>
<span class="token builtin class-name">.</span>
├── include
│   └── head.h	<span class="token operator">==</span><span class="token operator">></span> 头文件, 声明了加减乘除四个函数
├── main.c		<span class="token operator">==</span><span class="token operator">></span> 测试程序, 调用了 head.h 中的函数
└── src
    ├── add.c	<span class="token operator">==</span><span class="token operator">></span> 加法运算
    ├── div.c	<span class="token operator">==</span><span class="token operator">></span> 除法运算
    ├── mult.c  <span class="token operator">==</span><span class="token operator">></span> 乘法运算
    └── sub.c   <span class="token operator">==</span><span class="token operator">></span> 减法运算<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile">target<span class="token operator">=</span>app
src<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">wildcard</span> *.c ./src/*.c<span class="token punctuation">)</span>
obj<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">patsubst</span> %.c, %.o, <span class="token variable">$</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">include</span><span class="token operator">=</span>./<span class="token keyword">include</span>

<span class="token target symbol"><span class="token variable">$</span>(target)</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  gcc <span class="token variable">$^</span> -o <span class="token variable">$@</span>

<span class="token target symbol">%.o</span><span class="token punctuation">:</span>%.c
  gcc <span class="token variable">$&lt;</span> -c -I <span class="token variable">$</span><span class="token punctuation">(</span><span class="token keyword">include</span><span class="token punctuation">)</span> -o <span class="token variable">$@</span>

<span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span>clean
<span class="token target symbol">clean</span><span class="token punctuation">:</span>
  -rm <span class="token variable">$</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> -f<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="GDB-调试"><a href="#GDB-调试" class="headerlink" title="GDB 调试"></a>GDB 调试</h3><p>gdb 是由 GNU 软件系统社区提供的调试器，和 gcc 配套组成了一套完整的开发环境，支持并移植到各种类 Unix 系统与 Windows 系统里的 MinGW 和 Cygwin。gcc&#x2F;gdb 是 Linux 操作系统和许多类 Unix 操作系统的标准开发环境。</p>
<p>gdb 的吉祥物是射手鱼。</p>
<blockquote>
<p>For a fish, the archer fish is known to shoot down bugs from low hanging plants by spitting water at them.</p>
</blockquote>
<p>GDB 是一套字符界面的程序集，可以使用命令 gdb 加载要调试的程序。</p>
<h4 id="调试准备"><a href="#调试准备" class="headerlink" title="调试准备"></a>调试准备</h4><p>C 程序用 gcc 编译，C++ 程序用 g++ 编译。</p>
<ul>
<li><p>-g: 在可执行文件中加入源代码的信息，但并不是把源文件嵌入到可执行程序中，因此调试时，需要保证 gdb 能找到源文件。</p>
</li>
<li><p>-O0: 可选，关闭编译器的优化选项。</p>
</li>
<li><p>-Wall: 打印所有 warning。</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 源文件 main.c </span>
gcc <span class="token parameter variable">-g</span> main.c <span class="token parameter variable">-o</span> app<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="启动-gdb"><a href="#启动-gdb" class="headerlink" title="启动 gdb"></a>启动 gdb</h4><p>gdb 是一个用于应用程序调试的进程，gdb 启动后，被调试的应用程序是没有执行的。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gdb 可执行程序的名字

<span class="token comment"># example</span>
gdb app
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token comment"># gdb 等待输入调试的相关命令</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="命令行传参"><a href="#命令行传参" class="headerlink" title="命令行传参"></a>命令行传参</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// main.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NUM</span> <span class="token expression"><span class="token number">10</span></span></span>

<span class="token comment">// argc, argv 是命令行参数</span>
<span class="token comment">// 启动应用程序的时候</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"参数个数: %d\n"</span><span class="token punctuation">,</span> argc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>argc<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> NUM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"参数 %d: %s\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> argv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc main.c <span class="token parameter variable">-o</span> app <span class="token parameter variable">-g</span>

gdb app

<span class="token comment"># 设置命令行参数：启动 gdb 之后，应用程序启动之前</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> args 参数1 参数2 <span class="token punctuation">..</span>.
<span class="token comment"># 查看设置的命令行参数</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> show args

<span class="token comment"># example</span>
<span class="token comment"># 非 gdb 调试命令行传参</span>
<span class="token comment"># argc 参数总数，argv[0] = ./app，argv[1] = "11", argv[2] = "22" ...</span>
./app <span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span> <span class="token number">55</span>

<span class="token comment"># gdb 调试</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> args <span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span> <span class="token number">55</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> show args<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="gdb-中启动程序"><a href="#gdb-中启动程序" class="headerlink" title="gdb 中启动程序"></a>gdb 中启动程序</h4><p>在整个 gdb 调试过程中，启动应用程序的命令只能使用一次。</p>
<ul>
<li><p>run: 启动程序，缩写为 r，如果程序中设置了断点，会停在第一个断点的位置，如果没有设置断点，程序将执行完毕。</p>
</li>
<li><p>start:启动程序，会阻塞在 main 函数的第一行。</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 方式 1</span>
<span class="token comment"># run = r</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> run

<span class="token comment"># 方式 2</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 继续运行</span>
<span class="token comment"># continue = c</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">continue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="退出-gdb"><a href="#退出-gdb" class="headerlink" title="退出 gdb"></a>退出 gdb</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># quit = q</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> quit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="当前文件查看代码"><a href="#当前文件查看代码" class="headerlink" title="当前文件查看代码"></a>当前文件查看代码</h4><p>默认 main 函数所在的文件为当前文件。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查看代码</span>
<span class="token comment"># list = l</span>

<span class="token comment"># 从第一行开始显示</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> list

<span class="token comment"># 行号对应上下文代码，默认情况下只显示 10 行内容</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> list 行号

<span class="token comment"># 显示这个函数的上下文内容，默认显示 10 行</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> list 函数名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以继续执行 list 命令来继续查看后边的内容，也可以直接按 Enter 键（等价于执行上一次执行的那个 gdb 命令）。</p>
<h4 id="切换文件查看代码"><a href="#切换文件查看代码" class="headerlink" title="切换文件查看代码"></a>切换文件查看代码</h4><p>执行完切换命令之后，相应的文件就变成了当前文件。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 切换到指定的文件，并显示这行号对应的上下文代码，默认情况下只显示 10 行内容</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> l 文件名:行号

<span class="token comment"># 切换到指定的文件，并显示这个函数的上下文内容，默认显示 10 行</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> l 文件名:函数名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="设置显示的行数"><a href="#设置显示的行数" class="headerlink" title="设置显示的行数"></a>设置显示的行数</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># listsize 缩写: list</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> listsize 行数

<span class="token comment"># 查看当前 list 一次显示的行数</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> show listsize<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="设置断点"><a href="#设置断点" class="headerlink" title="设置断点"></a>设置断点</h4><ul>
<li><p>常规断点：程序运行到断点位置会被阻塞。</p>
</li>
<li><p>条件断点：只有指定的条件被满足了程序才会在断点处阻塞。</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 设置普通断点在当前文件</span>

<span class="token comment"># break = b</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b 行号

<span class="token comment"># 停止在函数的第一行</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b 函数名


<span class="token comment"># 设置普通断点到某个非当前文件上</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b 文件名:行号
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b 文件名:函数名

<span class="token comment"># 设置条件断点</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b 行数 <span class="token keyword">if</span> 变量名<span class="token operator">==</span>某个值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="查看断点"><a href="#查看断点" class="headerlink" title="查看断点"></a>查看断点</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># info = i</span>
<span class="token comment"># 查看断点信息</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b

<span class="token comment"># 举例</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400cb5 <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at test.cpp:12
<span class="token number">2</span>       breakpoint     keep y   0x0000000000400cbd <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at test.cpp:13
<span class="token number">3</span>       breakpoint     keep y   0x0000000000400cec <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at test.cpp:18
<span class="token number">4</span>       breakpoint     keep y   0x00000000004009a5 <span class="token keyword">in</span> insertionSort<span class="token punctuation">(</span>int*, int<span class="token punctuation">)</span> at insert.cpp:8
<span class="token number">5</span>       breakpoint     keep y   0x0000000000400cdd <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at test.cpp:16
<span class="token number">6</span>       breakpoint     keep y   0x00000000004009e5 <span class="token keyword">in</span> insertionSort<span class="token punctuation">(</span>int*, int<span class="token punctuation">)</span> at insert.cpp:16<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>Num: 断点的编号，删除断点和设置断点状态的时候需要使用。</p>
</li>
<li><p>Enb: 当前断点的状态，y 表示断点可用，n 表示断点不可用。</p>
</li>
<li><p>What: 描述断点被设置在哪个文件的哪行或者哪个函数上。</p>
</li>
</ul>
<h4 id="删除断点"><a href="#删除断点" class="headerlink" title="删除断点"></a>删除断点</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># delete = del = d</span>
<span class="token comment"># [] 表示可选</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> d 断点1的编号 <span class="token punctuation">[</span>断点2的编号<span class="token punctuation">]</span> <span class="token punctuation">..</span>.

<span class="token comment"># example</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> d <span class="token number">1</span> <span class="token comment"># 删除第一个断点</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> d <span class="token number">2</span> <span class="token number">4</span> <span class="token number">6</span>

<span class="token comment"># 删除一个断点区间，全闭</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> d num1-numN

<span class="token comment"># example</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> d <span class="token number">1</span>-5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="设置断点状态"><a href="#设置断点状态" class="headerlink" title="设置断点状态"></a>设置断点状态</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 断点失效后，gdb 调试过程中程序是不会停在这个位置的</span>
<span class="token comment"># disable = dis</span>
<span class="token comment"># 设置某一个或者某几个断点无效</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> dis 断点1的编号 <span class="token punctuation">[</span>断点2的编号<span class="token punctuation">]</span> <span class="token punctuation">..</span>.

<span class="token comment"># 设置某个区间断点无效</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> dis 断点1的编号-断点n的编号

<span class="token comment"># example</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> dis <span class="token number">2</span> <span class="token number">4</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> dis <span class="token number">5</span>-8

<span class="token comment"># enable = ena</span>
<span class="token comment"># 设置某一个或者某几个断点有效</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ena 断点1的编号 <span class="token punctuation">[</span>断点2的编号<span class="token punctuation">]</span> <span class="token punctuation">..</span>.

<span class="token comment"># 设置某个区间断点有效</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ena 断点1的编号-断点n的编号

<span class="token comment"># example</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ena <span class="token number">2</span> <span class="token number">4</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ena <span class="token number">5</span>-8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="继续运行-gdb"><a href="#继续运行-gdb" class="headerlink" title="继续运行 gdb"></a>继续运行 gdb</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># continue = c</span>
<span class="token comment"># 程序会继续运行，直到遇到下一个有效的断点</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">continue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="打印变量值"><a href="#打印变量值" class="headerlink" title="打印变量值"></a>打印变量值</h4><p>打印命令为 <code>print</code>，格式化输出字符如下表：</p>
<table>
<thead>
<tr>
<th align="center">格式化字符（&#x2F;fmt）</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">&#x2F;x</td>
<td align="center">十六进制形式打印整数</td>
</tr>
<tr>
<td align="center">&#x2F;d</td>
<td align="center">有符号、十进制形式打印整数</td>
</tr>
<tr>
<td align="center">&#x2F;u</td>
<td align="center">无符号、十进制形式打印整数</td>
</tr>
<tr>
<td align="center">&#x2F;o</td>
<td align="center">八进制打印整数</td>
</tr>
<tr>
<td align="center">&#x2F;t</td>
<td align="center">二进制打印整数</td>
</tr>
<tr>
<td align="center">&#x2F;f</td>
<td align="center">浮点数形式打印变量或者表达式的值</td>
</tr>
<tr>
<td align="center">&#x2F;c</td>
<td align="center">字符形式打印变量或者表达式的值</td>
</tr>
</tbody></table>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># print = p</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p 变量名

<span class="token comment"># 整型默认是十进制格式输出</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/fmt 变量名

<span class="token comment"># example</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p i
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x i
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/o i<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="打印变量类型"><a href="#打印变量类型" class="headerlink" title="打印变量类型"></a>打印变量类型</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ptype 变量名

<span class="token comment"># example</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ptype i
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ptype array<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ptype array<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="设置变量名的自动显示"><a href="#设置变量名的自动显示" class="headerlink" title="设置变量名的自动显示"></a>设置变量名的自动显示</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> display 变量名

<span class="token comment"># fmt 同 print</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> display/fmt 变量名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="查看自动显示列表"><a href="#查看自动显示列表" class="headerlink" title="查看自动显示列表"></a>查看自动显示列表</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># info == i</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> info display
Auto-display expressions now <span class="token keyword">in</span> effect:
Num Enb Expression
<span class="token number">1</span>:   y  i
<span class="token number">2</span>:   y  array<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token number">3</span>:   y  /x array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>Num: 变量或表达式的编号。</p>
</li>
<li><p>Enb: 表示当前变量或表达式的状态。y 表示值会被打印，n 表示值不会被打印。</p>
</li>
<li><p>Expression: 被自动打印值的变量或表达式的名字。</p>
</li>
</ul>
<h4 id="取消自动显示"><a href="#取消自动显示" class="headerlink" title="取消自动显示"></a>取消自动显示</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 删除自动显示列表中的变量或表达式</span>

<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> undisplay num1 <span class="token punctuation">[</span>num2<span class="token punctuation">]</span> <span class="token punctuation">..</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> undisplay num1-numN

<span class="token comment"># or</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> delete display num1 <span class="token punctuation">[</span>num2<span class="token punctuation">]</span> <span class="token punctuation">..</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> delete display num1-numN

<span class="token comment"># example</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> undisplay <span class="token number">1</span> <span class="token number">2</span>

<span class="token comment"># 禁用自动显示列表中处于激活状态的变量或者表达式</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disable display num1 <span class="token punctuation">[</span>num2<span class="token punctuation">]</span> <span class="token punctuation">..</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disable display num1-numN

<span class="token comment"># 启用自动显示列表中被禁用的变量或表达式</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">enable</span> display num1 <span class="token punctuation">[</span>num2<span class="token punctuation">]</span> <span class="token punctuation">..</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">enable</span> display num1-numN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="step"><a href="#step" class="headerlink" title="step"></a>step</h4><p>step 命令每次执行一次，程序将执行一行，如果这一行是一个函数调用，程序将会进入到函数内部。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># step = s</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> step<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="finish"><a href="#finish" class="headerlink" title="finish"></a>finish</h4><p>跳出函数体，前提：函数体内不能有有效断点。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> finish<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="next"><a href="#next" class="headerlink" title="next"></a>next</h4><p>next 命令和 step 命令功能相似，next 命令不会进入到函数内部。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># next = n</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> next<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="until"><a href="#until" class="headerlink" title="until"></a>until</h4><p>跳出循环体，前提：</p>
<ul>
<li><p>循环体内不能有有效断点。</p>
</li>
<li><p>必须在循环体的开始&#x2F;结束行执行 until 命令。</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token keyword">until</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="设置变量值"><a href="#设置变量值" class="headerlink" title="设置变量值"></a>设置变量值</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> var 变量名<span class="token operator">=</span>值<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>第十篇博文写完，开心！！！！</p>
<p>今天，也是充满希望的一天。</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">LuYF-Lemon-love</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://luyf-lemon-love.space/2022/05/24/00010-linux-ji-chu/">https://luyf-lemon-love.space/2022/05/24/00010-linux-ji-chu/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">LuYF-Lemon-love</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Linux/">
                                    <span class="chip bg-color">Linux</span>
                                </a>
                            
                                <a href="/tags/C/">
                                    <span class="chip bg-color">C++</span>
                                </a>
                            
                                <a href="/tags/make/">
                                    <span class="chip bg-color">make</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">谢谢小主！</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="https://cos.luyf-lemon-love.space/images/20220511162303.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="https://cos.luyf-lemon-love.space/images/20220511162220.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/05/27/00011-flowcharts-basic-syntax/">
                    <div class="card-image">
                        
                        <img src="https://cos.luyf-lemon-love.space/images/20220520214810.png" class="responsive-img" alt="00011-Flowcharts-Basic Syntax">
                        
                        <span class="card-title">00011-Flowcharts-Basic Syntax</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-05-27
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" class="post-category">
                                    计算机基础
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Markdown/">
                        <span class="chip bg-color">Markdown</span>
                    </a>
                    
                    <a href="/tags/Hexo/">
                        <span class="chip bg-color">Hexo</span>
                    </a>
                    
                    <a href="/tags/Butterfly/">
                        <span class="chip bg-color">Butterfly</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/05/23/00009-cf-812ac-wu-xian-wang-qia-qu-dong-an-zhuang/">
                    <div class="card-image">
                        
                        <img src="https://cos.luyf-lemon-love.space/images/20220520214839.png" class="responsive-img" alt="00009-CF-812AC无线网卡驱动安装">
                        
                        <span class="card-title">00009-CF-812AC无线网卡驱动安装</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-05-23
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%A1%AC%E4%BB%B6/" class="post-category">
                                    硬件
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E9%A9%B1%E5%8A%A8/">
                        <span class="chip bg-color">驱动</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022-2025</span>
            
            <a href="/about" target="_blank">LuYF-Lemon-love</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2022";
                        var startMonth = "5";
                        var startDate = "7";
                        var startHour = "4";
                        var startMinute = "53";
                        var startSecond = "32";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
                <span id="icp"><img src="/medias/icp.png"
                                    style="vertical-align: text-bottom;"/>
                <a href="https://beian.miit.gov.cn" target="_blank">冀ICP备2022012632号-1</a>
            </span>
            
            <br>
            
                <span id="gongan"><img src="https://cos.luyf-lemon-love.space/images/备案图标.png"
                                    style="vertical-align: text-bottom;"/>
                <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32011502011618" target="_blank">苏公网安备 32011502011618号</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/yanfeng98" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:luyanfeng_nlp@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
